"use strict";(()=>{var o="scriptsLoaded";var s="statItem",r="is-info-active";function i(){document.addEventListener("alpine:init",()=>{window.Alpine.data(s,function(){return{isInfoMode:!1,showPopover:!1,itemAttr:{":class"(){return this.isInfoMode&&r}},desktopTooltipTriggerAttr:{tabindex:"0","@mouseenter"(){this.showPopover=!0},"@mouseleave"(){this.showPopover=!1},"@focus"(){this.showPopover=!0},"@blur"(){this.showPopover=!1},"@keyup.escape"(){this.showPopover=!1}},tabletInfoTriggerAttr:{"@click"(){this.isInfoMode=!this.isInfoMode}}}})})}var a="stats",l=`https://cmsep-backend.mondopower.com.au/${townName}.json`,p=1*60*1e3;function n(){document.addEventListener("alpine:init",()=>{window.Alpine.data(a,function(){return{townName:"",lastUpdated:dayjs().tz().fromNow(),numberOfSystems:"",isExporting:!1,isPreStormResilience:!1,isResilience:!1,gridExportCount:"",isGridConnected:!1,isIslanded:!1,solarGenerating:"",solarCapacity:"",solarGeneratingPercent:0,batteryChargeState:"",batteryCapacity:"",batteryChargePercent:0,isError:!1,init(){this.queryData(),this.initPolling()},async queryData(){try{let t=await(await fetch(l)).json();this.isError=!1,console.debug("API Data fetched",t),this.townName=t.townName,this.lastUpdated=dayjs().tz().to(t.timestamp),this.numberOfSystems=t.numberOfSystems.toString(),this.isExporting=t.status==="Exporting",this.isPreStormResilience=t.status==="Pre-event resilience mode \u2013 charging",this.isResilience=t.status==="Resilience mode \u2013 conserve energy",this.gridExportCount=t.exportingToGrid.value+t.exportingToGrid.unit,this.isGridConnected=t.townSupplyStatus==="Grid connected",this.isIslanded=t.townSupplyStatus==="Islanded",this.solarGenerating=t.solar.generating.value+t.solar.generating.unit,this.solarCapacity=t.solar.capacity.value+t.solar.capacity.unit,this.solarGeneratingPercent=t.solar.generating.value/t.solar.capacity.value*100,this.batteryChargeState=t.batteries.stateOfCharge.value+t.batteries.stateOfCharge.unit,this.batteryCapacity=t.batteries.capacity.value+t.batteries.capacity.unit,this.batteryChargePercent=t.batteries.stateOfCharge.value}catch(e){this.isError=!0,console.error("Error in fetching the data",e)}},initPolling(){try{setInterval(()=>{this.queryData()},p)}catch(e){this.isError=!0,console.error("Error in polling the data",e)}}}})})}window.addEventListener(o,()=>{n(),i()});})();
