"use strict";(()=>{var a="stats",n=`https://cmsep-backend.mondopower.com.au/${townName}.json`,i=1*60*1e3;window.addEventListener("alpine:init",()=>{window.Alpine.data(a,function(){return{townName:"",lastUpdated:"",numberOfSystems:"",isExporting:!1,isPreStormResilience:!1,isResilience:!1,gridExportCount:"",isGridConnected:!1,isIslanded:!1,solarGenerating:"",solarCapacity:"",solarGeneratingPercent:0,batteryChargeState:"",batteryCapacity:"",batteryChargePercent:0,init(){this.queryData(),this.initPolling()},async queryData(){try{let t=await(await fetch(n)).json();console.debug("API Data fetched",t),this.townName=t.townName,this.lastUpdated=dayjs().to(t.timestamp),console.log(dayjs().to(t.timestamp)),this.numberOfSystems=t.numberOfSystems.toString(),this.isExporting=t.status==="Exporting",this.isPreStormResilience=t.status==="Pre-event resilience mode - charging",this.isResilience=t.status==="Resilience mode - conserve energy",this.gridExportCount=t.exportingToGrid.value+t.exportingToGrid.unit,this.isGridConnected=t.townSupplyStatus==="Grid connected",this.isIslanded=t.townSupplyStatus==="Islanded",this.solarGenerating=t.solar.generating.value+t.solar.generating.unit,this.solarCapacity=t.solar.capacity.value+t.solar.capacity.unit,this.solarGeneratingPercent=t.solar.generating.value/t.solar.capacity.value*100,this.batteryChargeState=t.batteries.stateOfCharge.value+t.batteries.stateOfCharge.unit,this.batteryCapacity=t.batteries.capacity.value+t.batteries.capacity.unit,this.batteryChargePercent=t.batteries.stateOfCharge.value}catch(e){console.error("Error in fetching the data",e)}},initPolling(){try{setInterval(this.queryData,i)}catch(e){console.error("Error in polling the data",e)}}}})});})();
